---
title: "Estimation and Hypothesis Testing"
author: "Brayan Duran Medina"
output: html_document
---

# Importing libraries
```{r}
library(readxl)
library(stats)
```

# Read data from Excel file
```{r}
data <- read_excel("GSS_1972_2014.xlsx")
```

# Print column names
```{r}
colnames(data)
```

# Correct answers to eleven Science questions
```{r}
correct_answers <- c("True", "False", "True", "False", "True",
                     "False", "True", "True", "True",
                     "Earth around sun", "One year")
```

# Extract people from year 2014
```{r}
data_2014 <- data[data$"Gss year for this respondent" == 2014, ]

data_2014
```

# Extract columns names with answers to Science questions
```{r}
science_questions <- colnames(data_2014)[c(42:52)]

science_questions
```

# Add new column with number of correct answers
```{r}
data_2014$correct_answers <- NA


for (i in seq_len(nrow(data_2014))) {
  data_2014$correct_answers[i] <-
    sum(data_2014[i, science_questions] == correct_answers)
}

data_2014$correct_answers
```

# Histogram of Number of Correct Answers
```{r}
data_2014_non_zero <- subset(data_2014, correct_answers > 0)

hist(data_2014_non_zero$correct_answers,
     main = "Histogram of Correct Answers",
     xlab = "Number of Correct Answers",
     ylab = "Frequency",
     col = "blue")
```

# ANOVA test for demographic variables
```{r}

demographic_variables <- c("Respondents sex",
                           "Age of respondent",
                           "Race of respondent",
                           "Marital status",
                           "Number of children",
                           "Highest year of school completed",
                           "Sexual orientation",
                           "Respondents income",
                           "Does r own or rent home?")

significant_variables <- c()

for (var in demographic_variables) {
  anova_result <- aov(correct_answers ~ data_2014[[var]], data = data_2014)

  print(paste("ANOVA for", var))

  print(summary(anova_result))

  boxplot(data_2014$correct_answers ~ data_2014[[var]],
          main = paste("Boxplot of Correct Answers by", var),
          xlab = var, ylab = "Number of Correct Answers", col = "lightgreen")

  if (summary(anova_result)[[1]][["Pr(>F)"]][1] < 0.05) {

    significant_variables <- c(significant_variables, var)
  }
}
```

# Make a Post Hoc test for significant variables
```{r}

for (var in significant_variables) {
  anova_result <- aov(correct_answers ~ data_2014[[var]], data = data_2014)

  posthoc_result <- TukeyHSD(anova_result)

  print(paste("Post-Hoc Test for", var))

  print(posthoc_result)

  aggregate_data <- aggregate(correct_answers ~ data_2014[[var]],
                              data = data_2014, mean)
  barplot(aggregate_data$correct_answers,
          names.arg = aggregate_data[, 1],
          main = paste("Bar Plot of Mean Correct Answers by", var),
          xlab = var, ylab = "Mean Number of Correct Answers", col = "coral")
}
```

# Summary Report on the Statistical Analysis of GSS 2014 Data

## Objective

The objective of this analysis was to assess the impact of various demographic factors on scientific knowledge as indicated by the number of correct science answers in the General Social Survey (GSS) 2014 data.

## Methodology

Analysis of Variance (ANOVA) was selected to evaluate the influence of demographic variables on scientific literacy. The variables examined include respondentsâ€™ sex, age, race, marital status, number of children, educational level, sexual orientation, income, and home ownership. This choice was based on the following reasons:

Applicability for Comparing Multiple Groups: ANOVA is particularly effective when comparing means across multiple groups, which is essential in our case with diverse demographic categories.

Suitability for Categorical Independent Variables: The demographic variables in our study are categorical, making ANOVA a suitable choice for understanding their impact on a continuous dependent variable (scientific literacy).

The methodology involves analyzing each demographic factor's influence on the respondents' number of correct science answers. Significant findings from the ANOVA were further investigated using Post Hoc tests, providing a more detailed understanding of the differences between specific groups within significant demographic categories. This approach ensures a comprehensive and statistically robust analysis, shedding light on the complex interplay between various demographic factors and scientific literacy.

## Key Findings

Respondent's Sex: A significant difference in scientific knowledge was observed between males and females.

Race of Respondent: Racial background showed a notable impact on scientific literacy levels.

Number of Children: The number of children a respondent has was significantly related to their scientific knowledge.

Educational Level: Higher education levels corresponded to greater scientific knowledge.

Sexual Orientation: Variations in scientific literacy were evident across different sexual orientations.

Income Levels: Respondents' income levels significantly influenced their scientific literacy.

## Conclusions

The analysis confidently suggests that demographic factors, namely sex, race, number of children, education, sexual orientation, and income level, play a significant role in determining the level of scientific knowledge among individuals. These insights are crucial for formulating targeted educational strategies and public awareness campaigns to enhance scientific literacy across diverse demographic segments.